
# STEP 1 – Service-Based Vulnerability Enumeration (Using Nmap NSE)

The purpose of this step is to identify vulnerabilities in running services on a target host, which helps in determining potential entry points for exploitation. 

This includes version detection and vulnerability mapping of services like FTP, SSH, Telnet, SMTP, and DNS.

---

## 1.1 Service-Based Vulnerability Enumeration  – Using `Nmap NSE Script`

### **Why This Tool Is Used**
The `Nmap NSE Script`is used to check:
- Nmap is a network scanning tool capable of detecting open ports and running services.
- The --script vuln option checks for known vulnerabilities in services.
- -sV performs service version detection, enabling identification of outdated or exploitable software.
- Helps security analysts and penetration testers prioritize targets for further exploitation.



---

### **Command**
    sudo nmap --script vuln -sV 192.168.56.102

## Output

    [sudo] password for lucifer: 
    Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-11 09:49 IST
    Nmap scan report for 192.168.56.102
    Host is up (0.00047s latency).
    Not shown: 977 closed tcp ports (reset)
    PORT     STATE SERVICE     VERSION
    21/tcp   open  ftp         vsftpd 2.3.4
    | ftp-vsftpd-backdoor: 
    |   VULNERABLE:
    |   vsFTPd version 2.3.4 backdoor
    |     State: VULNERABLE (Exploitable)
    |     IDs:  BID:48539  CVE:CVE-2011-2523
    |       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
    |     Disclosure date: 2011-07-03
    |     Exploit results:
    |       Shell command: id
    |       Results: uid=0(root) gid=0(root)
    |     References:
    |       https://www.securityfocus.com/bid/48539
    |       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
    |       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
    |_      http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
    22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
    | vulners: 
    |   cpe:/a:openbsd:openssh:4.7p1: 
    |       CVE-2023-38408  9.8     https://vulners.com/cve/CVE-2023-38408
    |       CVE-2016-1908   9.8     https://vulners.com/cve/CVE-2016-1908
    |       CVE-2015-5600   8.5     https://vulners.com/cve/CVE-2015-5600
    |       CVE-2016-10012  7.8     https://vulners.com/cve/CVE-2016-10012
    |       CVE-2015-8325   7.8     https://vulners.com/cve/CVE-2015-8325
    |       CVE-2016-10708  7.5     https://vulners.com/cve/CVE-2016-10708
    |       CVE-2016-10009  7.5     https://vulners.com/cve/CVE-2016-10009
    |       CVE-2014-1692   7.5     https://vulners.com/cve/CVE-2014-1692
    23/tcp   open  telnet      Linux telnetd
    25/tcp   open  smtp        Postfix smtpd
    | ssl-dh-params: 
    |   VULNERABLE:
    |   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability
    |     State: VULNERABLE
    |   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)
    |     State: VULNERABLE
    |       IDs:  BID:74733  CVE:CVE-2015-4000
    |   Diffie-Hellman Key Exchange Insufficient Group Strength
    |     State: VULNERABLE
    | ssl-poodle: 
    |   VULNERABLE:
    |   SSL POODLE information leak
    |     State: VULNERABLE
    |     IDs:  BID:70574  CVE:CVE-2014-3566
    53/tcp   open  domain      ISC BIND 9.4.2
    | vulners: 
    |   CVE-2008-0122   10.0    https://vulners.com/cve/CVE-2008-0122
    |   CVE-2021-25216  9.8     https://vulners.com/cve/CVE-2021-25216
    |   CVE-2020-8616   8.6     https://vulners.com/cve/CVE-2020-8616
    |   CVE-2016-1286   8.6     https://vulners.com/cve/CVE-2016-1286
(Output truncated for brevity; full output includes all exploits listed for SSH, FTP, and BIND.)

## Findings
- FTP (vsftpd 2.3.4): Backdoor exists; root shell is obtainable.
- SSH (OpenSSH 4.7p1): Multiple CVEs ranging 9.8–3.6 severity, including remote code execution exploits.
- SSH (OpenSSH 4.7p1): Multiple CVEs ranging 9.8–3.6 severity, including remote code execution exploits.
- SMTP (Postfix): TLS configuration is weak (Anonymous DH, Logjam, SSL POODLE).
- DNS (BIND 9.4.2): Multiple critical vulnerabilities (CVE-2008-0122, CVE-2021-25216, CVE-2020-8616).

## Interpretation
- The FTP service is critical: exploitable backdoor allows root access immediately.
- SSH is vulnerable: outdated version exposes the host to multiple attacks (RCE, enumeration).
- SMTP encryption is weak: susceptible to MitM attacks, data interception possible.
- DNS service is outdated: may allow denial-of-service or remote exploits.
- Overall, the host is highly vulnerable, and FTP/SSH are priority targets for penetration testing.

---

