
# STEP 2 – Protocol Specific Vulnerability Checks

The purpose of this step is to identify vulnerabilities in running services on a target host, which helps in determining potential entry points for exploitation. 

This includes version detection and vulnerability mapping of services like FTP, SSH, Telnet, SMTP, and DNS.

---

## 2.1 SMB Vulnerability Assessment – Using nmap --script smb-vuln*

## Purpose

To detect known SMB-related vulnerabilities by running protocol-specific Nmap scripts that check for insecure or outdated SMB implementations.

### **Why This Tool Is Used**
The `nmap --script smb-vuln*`is used to check:
- To automatically test for known SMB vulnerabilities such as MS10-054 and MS10-061.
- To determine whether the SMB service is exploitable or properly patched.
- To identify misconfigurations or weak SMB protocol implementations.
- To quickly assess SMB security without needing manual exploitation.
- To validate whether SMB can be used as an attack vector in later phases.


---

### **Command**
    sudo nmap --script smb-vuln* -p 445 192.168.56.102

## Output
    Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-11 10:23 IST
    Nmap scan report for 192.168.56.102
    Host is up (0.00055s latency).

    PORT    STATE SERVICE
    445/tcp open  microsoft-ds
    MAC Address: 08:00:27:F0:BB:3D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

    Host script results:
    |_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)
    |_smb-vuln-ms10-061: false
    |_smb-vuln-ms10-054: false

    Nmap done: 1 IP address (1 host up) scanned in 6.30 seconds


## Findings
- Port 445 (SMB) is open and reachable.
- Port 445 (SMB) is open and reachable.
  - MS10-061 (Print Spooler RCE)
  - MS10-054 (SMB memory corruption)
- The script smb-vuln-regsvc-dos failed to execute, resulting in incomplete information.
- SMB service appears to be patched against the vulnerabilities checked.

## Interpretation
- The SMB service is active and accessible, but not immediately exploitable.
- The host is not vulnerable to several major historical SMB exploits.
- Additional tools may be required to validate DoS-related risks due to script failure.
- SMB remains a potential enumeration target, but exploitation opportunities appear limited.
- The system shows signs of being maintained or hardened against known SMB vulnerabilities.
---

## 2.2 FTP Vulnerability Assessment

## 2.2.1 Anonymous Login Test – Using ftp-anon Script

## Purpose

To determine whether the FTP server allows anonymous login, which can expose sensitive files or permit unauthorized access.

### **Why This Tool Is Used**
The `ftp-anon Script`is used to check:
- To check if the FTP service permits anonymous authentication.
- To identify misconfigured FTP access controls.
- To assess whether attackers can access public or sensitive directories without credentials.
- To validate FTP as a potential entry point for initial compromise.


---

### **Command**
    sudo nmap --script ftp-anon -p 21 192.168.56.102

## Output
    Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-11 10:24 IST
    Nmap scan report for 192.168.56.102
    Host is up (0.00048s latency).

    PORT   STATE SERVICE
    21/tcp open  ftp
    |_ftp-anon: Anonymous FTP login allowed (FTP code 230)
    MAC Address: 08:00:27:F0:BB:3D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

    Nmap done: 1 IP address (1 host up) scanned in 1.27 seconds

## Findings
- The FTP service is running on port 21.
- Anonymous login is enabled, confirmed by FTP response code 230.
- No additional restrictions or warnings are shown.

## Interpretation
- Attackers can log in without credentials, increasing unauthorized access risk.
- Files stored in FTP directories may be publicly accessible or downloadable.
- This is a critical misconfiguration often used for privilege escalation.
- The system requires immediate FTP hardening, including disabling anonymous access.
- Further directory enumeration is recommended to identify sensitive data exposure.

## 2.2.2 Known FTP Vulnerabilities Scan – Using ftp-vuln* Script

## Purpose
To identify whether the FTP service is affected by any known vulnerabilities, such as misconfigurations, buffer overflows, or outdated FTP server versions.

The `ftp-vuln script`is used to check:
- To check for publicly known FTP exploits associated with the server version.
- To detect misconfigurations, weak permissions, or insecure commands.
- To validate whether the FTP server is patched or outdated.
- To understand if FTP can be used as a vector for remote code execution or DoS attacks.

---

### **Command**

    sudo nmap --script ftp-vuln* -p 21 192.168.56.102


## Output
    Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-11 10:25 IST
    Nmap scan report for 192.168.56.102
    Host is up (0.00029s latency).
  
    PORT   STATE SERVICE
    21/tcp open  ftp
    MAC Address: 08:00:27:F0:BB:3D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

    Nmap done: 1 IP address (1 host up) scanned in 0.40 seconds

## Findimgs
- Port 21 (FTP) is open and responding.
- No known vulnerabilities detected by Nmap’s ftp-vuln* scripts.
- The FTP server did not trigger any vulnerability signatures.

## Interpretation 
- The FTP server appears to be patched or not affected by known vulnerabilities scanned.
- Despite no vulnerabilities found, anonymous login still poses a significant security risk.
- Lack of detected vulnerabilities does not guarantee the server is secure; further manual testing may be required.
- The server might be running an older version with limited script coverage.
- FTP should still be considered a high-risk surface due to insecure configuration.

---

## 2.3 SSH Weak Algorithm & Host Key Vulnerability Assessment
## 2.3.1 Weak Algorithm Scan – Using ssh2-enum-algos

## Purpose 
To enumerate all SSH cryptographic algorithms supported by the server and identify weak, deprecated, or insecure algorithms.

### **Why This Tool Is Used**
The `ssh2-enum-alogs`is used to check:
- To detect weak or deprecated key exchange (KEX) algorithms.
- To identify insecure encryption ciphers still in use.
- To analyze MAC algorithms vulnerable to integrity attacks.
- To locate outdated or deprecated server host key types.
- To assess overall cryptographic strength of the SSH service.
- To determine whether SSH can be exploited due to weak crypto support.


---

### **Command**
    sudo nmap --script ssh2-enum-algos -p 22 192.168.56.102

## Output
    PORT   STATE SERVICE
    22/tcp open  ssh
    | ssh2-enum-algos: 
    |   kex_algorithms: (4)
    |       diffie-hellman-group-exchange-sha256
    |       diffie-hellman-group-exchange-sha1
    |       diffie-hellman-group14-sha1
    |       diffie-hellman-group1-sha1
    |   server_host_key_algorithms: (2)
    |       ssh-rsa
    |       ssh-dss
    |   encryption_algorithms: (13)
    |       aes128-cbc
    |       3des-cbc
    |       blowfish-cbc
    |       cast128-cbc
    |       arcfour128
    |       arcfour256
    |       arcfour
    |       aes192-cbc
    |       aes256-cbc
    |       rijndael-cbc@lysator.liu.se
    |       aes128-ctr
    |       aes192-ctr
    |       aes256-ctr
    |   mac_algorithms: (7)
    |       hmac-md5
    |       hmac-sha1
    |       umac-64@openssh.com
    |       hmac-ripemd160
    |       hmac-ripemd160@openssh.com
    |       hmac-sha1-96
    |       hmac-md5-96
    |   compression_algorithms: (2)
    |       none
    |_      zlib@openssh.com

## Findings
- SSH supports multiple weak or deprecated KEX algorithms, including diffie-hellman-group1-sha1.
- Insecure encryption ciphers present, such as:
  - 3des-cbc
  - arcfour / arcfour128 / arcfour256
  - blowfish-cbc
- Weak MAC algorithms detected (e.g., hmac-md5, hmac-sha1-96).
- Uses legacy host key types (ssh-rsa and ssh-dss).
- Compression enabled, which can lead to "deflate" attacks in outdated implementations.

## Interpretation
- The SSH server is using outdated and insecure cryptographic algorithms that weaken confidentiality and integrity.
- diffie-hellman-group1-sha1 is considered cryptographically broken and vulnerable to MITM attacks.
- CBC ciphers such as AES-CBC and 3DES are vulnerable to padding oracle attacks.
- Use of DSA keys (ssh-dss) indicates poor security; DSA is deprecated.
- Attackers can potentially downgrade to weaker algorithms to exploit SSH.
- Server should be reconfigured to support only modern, strong algorithms such as:
  - curve25519-sha256
  - ecdh-sha2-nistp256
  - chacha20-poly1305
  - hmac-sha2-256
- The SSH cryptographic profile is highly vulnerable and outdated.
---

## 2.3.2 Weak Key / Host Key Vulnerability Test – Using ssh-hostkey

## Purpose
To extract the SSH host public keys and check for weak, short, or deprecated key types that may allow impersonation or brute-force attacks.

### **Why This Tool Is Used**
The `ssh-hostkey`is used to check:
- To identify deprecated key types such as DSA.
- To determine whether RSA keys are short or weakly generated.
- To verify if the server uses multiple host key types, which expands the attack surface.
- To assess exposure to known SSH key brute-force or MITM attacks.
- To gather key fingerprints for security auditing or trust validation.
---

### **Command**
    sudo nmap --script ssh-hostkey -p 22 192.168.56.102

## Output
    PORT   STATE SERVICE
    22/tcp open  ssh
    | ssh-hostkey: 
    |   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
    |_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)

## Findings
- SSH exposes two host key types:
  - 1024-bit DSA key (deprecated, insecure)
  - 2048-bit RSA key (usable but outdated compared to modern 3072/4096-bit keys)
- DSA key size is fixed at 1024 bits, making it inherently weak.
- Fingerprints of both keys are visible, meaning:
  - The server uses old key formats
  - Host keys have not been modernized or rotated

## Interpretation
- Use of DSA (ssh-dss) indicates a high-risk configuration, as DSA is deprecated and insecure.
- RSA key strength (2048-bit) is acceptable but not optimal for modern security.
- Weak host keys increase risk of:
  - Man-in-the-Middle (MITM) attacks
  - Key brute force or impersonation attacks
- SSH configuration must be updated to remove weak key types and use secure ones such as:
  - ed25519
  - rsa-3072 or rsa-4096
- The presence of outdated key types confirms the system is running an old SSH version and requires immediate hardening.
--- 

## 2.4 HTTP Vulnerability Assessment (Nikto + Nmap NSE)
## 2.4.1  Nikto Deep Scan

## Purpose
To identify outdated software versions, misconfigurations, dangerous files, and known web server vulnerabilities.

### **Why This Tool Is Used**
The `ssh-hostkey`is used to check:
- To perform comprehensive vulnerability detection on the web server, including outdated software, insecure files, and misconfigurations.
- To identify common CVEs, suspicious directories, and dangerous HTTP methods.
- To detect server security weaknesses such as default files, debug pages, and exposed configuration data.
- To detect server security weaknesses such as default files, debug pages, and exposed configuration data.
---

### **Command**
    nikto -h http://192.168.56.102

## Output
    - Nikto v2.5.0
    ---------------------------------------------------------------------------
    + Target IP:          192.168.56.102
    + Target Hostname:    192.168.56.102
    + Target Port:        80
    + Start Time:         2025-12-11 10:26:06 (GMT5.5)
    ---------------------------------------------------------------------------
    + Server: Apache/2.2.8 (Ubuntu) DAV/2
    + /: Retrieved x-powered-by header: PHP/5.2.4-2ubuntu5.10.
    + /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options
    + /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https://www.netsparker.com/web-  vulnerability-scanner/vulnerabilities/missing-content-type-header/
    + Apache/2.2.8 appears to be outdated (current is at least Apache/2.4.54). Apache 2.2.34 is the EOL for the 2.x branch.
    + /index: Uncommon header 'tcn' found, with contents: list.
    + /index: Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. The following alternatives for 'index' were found: index.php. See: http://www.wisec.it/sectou.php?id=4698ebdc59d15,https://exchange.xforce.ibmcloud.com/vulnerabilities/8275
    + /: Web Server returns a valid response with junk HTTP methods which may cause false positives.
    + /: HTTP TRACE method is active which suggests the host is vulnerable to XST. See: https://owasp.org/www-community/attacks/Cross_Site_Tracing
    + /phpinfo.php: Output from the phpinfo() function was found.
    + /doc/: Directory indexing found.
    + /doc/: The /doc/ directory is browsable. This may be /usr/doc. See: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-0678
    + /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184
    + /?=PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184
    + /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184
    + /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184
    + /phpMyAdmin/changelog.php: phpMyAdmin is for managing MySQL databases, and should be protected or limited to authorized hosts.
    + /phpMyAdmin/ChangeLog: Server may leak inodes via ETags, header found with file /phpMyAdmin/ChangeLog, inode: 92462, size: 40540, mtime: Tue Dec  9 22:54:00 2008. See: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1418
    + /phpMyAdmin/ChangeLog: phpMyAdmin is for managing MySQL databases, and should be protected or limited to authorized hosts.
    + /test/: Directory indexing found.
    + /test/: This might be interesting.
    + /phpinfo.php: PHP is installed, and a test script which runs phpinfo() was found. This gives a lot of system information. See: CWE-552
    + /icons/: Directory indexing found.
    + /icons/README: Apache default file found. See: https://www.vntweb.co.uk/apache-restricting-access-to-iconsreadme/
    + /phpMyAdmin/: phpMyAdmin directory found.
    + /phpMyAdmin/Documentation.html: phpMyAdmin is for managing MySQL databases, and should be protected or limited to authorized hosts.
    + /phpMyAdmin/README: phpMyAdmin is for managing MySQL databases, and should be protected or limited to authorized hosts. See: https://typo3.org/
    + /#wp-config.php#: #wp-config.php# file found. This file contains the credentials.
    + 8910 requests: 0 error(s) and 27 item(s) reported on remote host
    + End Time:           2025-12-11 10:26:41 (GMT5.5) (35 seconds)
    ---------------------------------------------------------------------------
    + 1 host(s) tested

## Findings
- Outdated Apache 2.2.8 web server with known vulnerabilities.
- Missing security headers (X-Frame-Options, X-Content-Type-Options).
- HTTP TRACE enabled, exposing server to Cross-Site Tracing attacks.
- Browsable directories (/doc, /icons, /test).
- Sensitive files exposed (phpinfo.php, phpMyAdmin, wp-config backup).
- PHP information disclosure through special query strings.
- Server returns responses to junk HTTP methods, increasing attack surface.

## Interpretation
- The web server is running outdated software that is no longer supported, making it vulnerable to many known exploits.
- Missing security headers indicate poor hardening and exposure to clickjacking and MIME-type attacks.
- Public directory browsing reveals sensitive files that attackers can use for reconnaissance.
- Exposed phpMyAdmin and phpinfo.php give attackers powerful entry points for exploitation.
- TRACE method and MultiViews feature increase risk of data leakage and brute-force attacks.
---

## 2.4.2 Nmap HTTP Vulnerability Scripts

## Purpose
To detect known HTTP-related vulnerabilities using Nmap’s automated NSE vulnerability scripts.


### **Why This Tool Is Used**
The `ssh-hostkey`is used to check:
- To test the web server for known HTTP-based vulnerabilities using the Nmap NSE script library.
- To identify misconfigurations, weak SSL/TLS settings, and outdated server components.
- To validate specific CVEs using targeted scripts such as http-vuln-cve*, http-enum, http-methods, http-server-header.
- To obtain structured, script-level security insights for deeper manual validation. 

---

### **Command**
    sudo nmap --script http-vuln* -p 80,443 192.168.56.102

## Output
    [sudo] password for lucifer: 
    Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-11 10:26 IST
    Nmap scan report for 192.168.56.102
    Host is up (0.00026s latency).

    PORT    STATE  SERVICE
    80/tcp  open   http
    |_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)
    443/tcp closed https
    MAC Address: 08:00:27:F0:BB:3D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
 
Nmap done: 1 IP address (1 host up) scanned in 0.95 seconds

## Findings 
- Port 80 is open and running a vulnerable HTTP service.
- The script for CVE-2017-1001000 failed, which may indicate server incompatibility or missing responses.
- HTTPS port 443 is closed, meaning no SSL/TLS protection is enabled.

## Interpretation 
- The server likely lacks protection against important web vulnerabilities due to outdated software.
- Failure of vulnerability scripts may indicate unstable or misconfigured HTTP service.
- Absence of HTTPS means all communication occurs in plaintext, enabling interception and manipulation attacks.
--- 
