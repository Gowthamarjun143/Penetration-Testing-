# Exploitation Phase – 5. RSH Authentication Trust Misconfiguration

---

## Vulnerability Phase Identification

**Phase:** Exploitation  
**Vulnerability Identified During:** Scanning & Vulnerability Assessment  
**Affected Service:** Remote Shell(RSH)
**Service Version:** rsh/rlogin
**Port:** TCP 514

This vulnerability was identified during service enumeration when legacy remote services were found exposed on the target system.

---

## Vulnerability Overview

The Remote Shell (RSH) service is an insecure legacy protocol that relies on host-based trust authentication instead of passwords.

If misconfigured (e.g., weak .rhosts or /etc/hosts.equiv entries), attackers may gain unauthenticated remote command execution.

### Impact
- Authentication bypass (if trust relationships exist)
- Remote command execution
- Potential root-level access
- Lateral movement within trusted networks

Due to its insecure design, RSH is considered high-risk and deprecated.

---

## Tool Used: Metasploit Framework

### Why This Tool Is Used
- Provides a dedicated scanner for RSH authentication weaknesses
- Tests for anonymous, blank, and trust-based logins
- Identifies misconfigured trust relationships
- Industry-standard penetration testing framework

### Tool Explanation
The rsh_login auxiliary module attempts authentication using blank usernames, default system users, and trust-based login mechanisms to determine whether the RSH service can be abused.

---

## Exploit Module Information

- **Module Name:** `auxiliary/scanner/rservices/rsh_login`
- **Module Type: Authentication Scanner
- **Exploit Type:** Trust-based / No-password
- **Default Backdoor Port:** 514

---

## Exploitation Command Sequence

    msfconsole -q
    use auxiliary/scanner/rservices/rsh_login
    set RHOSTS 192.168.56.102
    exploit

## Exploit Output (Successful)

    [*] 192.168.56.102:514 - Starting rsh sweep
    [*] Attempting rsh with username '' from 'root'
    [-] Result: getnameinfo: Temporary failure in name resolution
     Attempting rsh with username '' from 'daemon'
    [-] Result: getnameinfo: Temporary failure in name resolution
    [*] Attempting rsh with username '' from 'bin'
    [-] Result: getnameinfo: Temporary failure in name resolution
    [*] Attempting rsh with username '' from 'nobody'
    [-] Result: getnameinfo: Temporary failure in name resolution
    [*] Scanned 1 of 1 hosts (100% complete)
    [*] Auxiliary module execution completed


## Exploitation Result

Status: ❌ Exploitation Not Successful

Session Opened: No

Reason:
- No valid trust relationship was found
- .rhosts / hosts.equiv did not permit unauthenticated access
- DNS resolution issues further prevented trust-based authentication

## Security Findings
- RSH service is enabled and exposed
- Legacy insecure protocol detected
- No immediate exploitation possible
- Service presence alone represents a security risknb 

## Risk Assessment
| Factor | Severity |
|---|------|
| Service Exposure | High  | 
| Authentication model | Weak | 
| Exploit success | No | 
| Privilege Gained | None |
| Overall Risk | Medium |
## Remediation Recommendations
- Disable RSH entirely (rsh-server, rlogin, rexec)
- Remove .rhosts and /etc/hosts.equiv files
- Replace RSH with SSH
- Block TCP port 514 at firewall level
- Audit systems for legacy remote services
-  Enforce strong authentication and encryption

## Conclusion
Although exploitation was not successful, the presence of RSH represents a serious security misconfiguration.

 RSH relies on outdated trust-based authentication and provides no encryption, making it unsuitable for modern environments.

This finding highlights the importance of:
- Removing legacy services
- Hardening exposed network services
- Enforcing secure remote access mechanisms

---
